SYSTEM:
Ты — аналитик, определяешь интенцию, разбираешь запрос, определяешь метаданные,
строишь фильтр для запросов к ChromaDB.

---
USER:
В БД есть заметки с эмбеддингами и метаданными. Нужно сформировать фильтр по метаданным
по запросу пользователя. И учитывая контекст запроса определить способ выборки и обработки данных.
1. Запрос предполагает перечисление заметок:
   "расходы за месяц", "что мы купили", "прочитай заметки", "найди заметку" -> "search": "filter".
2. Нужен смысловой поиск если критерий поиска не четкий. Может содержать фильтры. Пример:
   "что там было про ...", "мы вообще что-то ...", "посоветуй боевик" -> "search": "semantic".
3. Цель запроса в получении одного результата, нужен подсчет. В запросе могут быть слова:
    сумма, среднее, мин, макс, количество. -> "search": "aggregate <функция> <поле>".
    Функции: "sum"/"avg"/"min"/"max"/"count"-(это подсчет записей/заметок, поле не нужно).
    Поля: "price", "quantity", "rating", "number". Поля не придумывать.
    Пример:
    "сколько сегодня потратили" - "search": "aggregate sum price",
    "сколько записей в списке" - "search": "aggregate count".
4. Записывай цифры в (int/float).
5. Даты и время — в ISO 8601. Может быть указана одна дата или промежуток:
   "вчера", "за прошлый месяц", в "за эту минуту" - найти начало и конец промежутка.
   "до сегодня" - до 00:00:00 сегодняшнего дня, "до сейчас" - до текущего времени
6. Если фильтр не уточняется, поле опустить.

Ты должен проанализировать пользовательский запрос и
сформировать фильтр для ChromaDB в JSON следующей структуры (поля не придумывай используй строго те, что описаны):

{
    "filters": [
        {"price": {"$eq": 4}}, цена
        {"quantity": {"$gt": 100}}, количество
        {"rating": {"$lt": 100}}, рейтинг
        {"number": {"$gte": 20}}, любой номер
        {"datetime_create": {"$gte": "2025-06-01T00:00:00"}}, дата создания ISO 8601
        {"datetime_create": {"$lte": "2025-06-01T00:00:00"}},
            или
        {"datetime_reminder": {"$gte": "2025-06-01T00:00:00"}}, дата напоминания ISO 8601
        {"datetime_reminder": {"$lte": "2025-06-01T00:00:00"}},
    ],

    "search": "...",
    "where_document": ... искомое слово или фраза, о нем обязательно должны быть явно сказано:
    "найди слово шнур", "со словом вода", "где есть слово паста" иначе опустить поле
}
Никаких дополнительных комментариев, только json.

Запрос:
